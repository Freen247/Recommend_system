## 模型设计阶段性报告
### model_0
结合使用文本卷积、GRU（Gate Recurrent Unit）循环神经网络构建模型。
```
book_blurb_gru_layer= (None, 32)
user_dense_layer_flat= (None, 200)
book_dense_layer_flat= (None, 200)
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
book_title_input (InputLayer)   [(None, 15)]         0
__________________________________________________________________________________________________
book_title_embed_layer (Embeddi (None, 15, 16)       379696      book_title_input[0][0]
__________________________________________________________________________________________________
tf_op_layer_ExpandDims_1 (Tenso [(None, 15, 16, 1)]  0           book_title_embed_layer[0][0]
__________________________________________________________________________________________________
user_location_input (InputLayer [(None, 3)]          0
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 14, 1, 8)     264         tf_op_layer_ExpandDims_1[0][0]
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 13, 1, 8)     392         tf_op_layer_ExpandDims_1[0][0]
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 12, 1, 8)     520         tf_op_layer_ExpandDims_1[0][0]
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 11, 1, 8)     648         tf_op_layer_ExpandDims_1[0][0]
__________________________________________________________________________________________________
book_blurb_input (InputLayer)   [(None, 200)]        0
__________________________________________________________________________________________________
location_embed_layer (Embedding (None, 3, 16)        121184      user_location_input[0][0]
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 1, 1, 8)      0           conv2d[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 1, 1, 8)      0           conv2d_1[0][0]
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 1, 1, 8)      0           conv2d_2[0][0]
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 1, 1, 8)      0           conv2d_3[0][0]
__________________________________________________________________________________________________
book_blurb_embed_layer (Embeddi (None, 200, 16)      2032560     book_blurb_input[0][0]
__________________________________________________________________________________________________
user_id_input (InputLayer)      [(None, 1)]          0
__________________________________________________________________________________________________
location_fc_layer (Dense)       (None, 3, 32)        544         location_embed_layer[0][0]
__________________________________________________________________________________________________
book_isbn_input (InputLayer)    [(None, 1)]          0
__________________________________________________________________________________________________
book_author_input (InputLayer)  [(None, 1)]          0
__________________________________________________________________________________________________
book_year_input (InputLayer)    [(None, 1)]          0
__________________________________________________________________________________________________
book_publisher_input (InputLaye [(None, 1)]          0
__________________________________________________________________________________________________
title_pool_layer (Concatenate)  (None, 1, 1, 32)     0           max_pooling2d[0][0]
                                                                 max_pooling2d_1[0][0]
                                                                 max_pooling2d_2[0][0]
                                                                 max_pooling2d_3[0][0]
__________________________________________________________________________________________________
book_blurb_dense_layer (Dense)  (None, 200, 32)      544         book_blurb_embed_layer[0][0]
__________________________________________________________________________________________________
uid_embed_layer (Embedding)     (None, 1, 16)        461376      user_id_input[0][0]
__________________________________________________________________________________________________
location_gru_layer (GRU)        (None, 32)           6336        location_fc_layer[0][0]
__________________________________________________________________________________________________
book_isbn_embed_layer (Embeddin (None, 1, 16)        608576      book_isbn_input[0][0]
__________________________________________________________________________________________________
book_author_embed_layer (Embedd (None, 1, 16)        243136      book_author_input[0][0]
__________________________________________________________________________________________________
book_year_embed_layer (Embeddin (None, 1, 16)        1296        book_year_input[0][0]
__________________________________________________________________________________________________
book_publisher_embed_layer (Emb (None, 1, 16)        46544       book_publisher_input[0][0]
__________________________________________________________________________________________________
pool_layer_flat (Reshape)       (None, 1, 32)        0           title_pool_layer[0][0]
__________________________________________________________________________________________________
book_blurb_gru_layer (GRU)      (None, 32)           6336        book_blurb_dense_layer[0][0]
__________________________________________________________________________________________________
uid_fc_layer (Dense)            (None, 1, 32)        544         uid_embed_layer[0][0]
__________________________________________________________________________________________________
tf_op_layer_ExpandDims (TensorF [(None, 1, 32)]      0           location_gru_layer[0][0]
__________________________________________________________________________________________________
book_isbn_dense_layer (Dense)   (None, 1, 32)        544         book_isbn_embed_layer[0][0]
__________________________________________________________________________________________________
book_author_dense_layer (Dense) (None, 1, 32)        544         book_author_embed_layer[0][0]
__________________________________________________________________________________________________
book_year_dense_layer (Dense)   (None, 1, 32)        544         book_year_embed_layer[0][0]
__________________________________________________________________________________________________
book_publisher_dense_layer (Den (None, 1, 32)        544         book_publisher_embed_layer[0][0]
__________________________________________________________________________________________________
dropout_layer (Dropout)         (None, 1, 32)        0           pool_layer_flat[0][0]
__________________________________________________________________________________________________
tf_op_layer_ExpandDims_2 (Tenso [(None, 1, 32)]      0           book_blurb_gru_layer[0][0]
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 1, 64)        0           uid_fc_layer[0][0]
                                                                 tf_op_layer_ExpandDims[0][0]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1, 192)       0           book_isbn_dense_layer[0][0]
                                                                 book_author_dense_layer[0][0]
                                                                 book_year_dense_layer[0][0]
                                                                 book_publisher_dense_layer[0][0]
                                                                 dropout_layer[0][0]
                                                                 tf_op_layer_ExpandDims_2[0][0]
__________________________________________________________________________________________________
user_dense_layer (Dense)        (None, 1, 200)       13000       concatenate[0][0]
__________________________________________________________________________________________________
dense (Dense)                   (None, 1, 200)       38600       concatenate_1[0][0]
__________________________________________________________________________________________________
user_combine_layer_flat (Reshap (None, 200)          0           user_dense_layer[0][0]
__________________________________________________________________________________________________
book_dense_layer_flat (Reshape) (None, 200)          0           dense[0][0]
__________________________________________________________________________________________________
user_book_feature (Lambda)      (None, 1)            0           user_combine_layer_flat[0][0]
                                                                 book_dense_layer_flat[0][0]
==================================================================================================
Total params: 3,964,272
Trainable params: 3,964,272
Non-trainable params: 0
```
### model_1
结合使用文本卷积、lstm循环神经网络构建模型。
```
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
book_title_input (InputLayer)   [(None, 15)]         0                                            
__________________________________________________________________________________________________
book_title_embedding (Embedding (None, 15, 32)       762080      book_title_input[0][0]           
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 15, 32, 1)    0           book_title_embedding[0][0]       
__________________________________________________________________________________________________
book_isbn_input (InputLayer)    [(None, 1)]          0                                            
__________________________________________________________________________________________________
book_author_input (InputLayer)  [(None, 1)]          0                                            
__________________________________________________________________________________________________
book_year_input (InputLayer)    [(None, 1)]          0                                            
__________________________________________________________________________________________________
book_publisher_input (InputLaye [(None, 1)]          0                                            
__________________________________________________________________________________________________
user_id_input (InputLayer)      [(None, 1)]          0                                            
__________________________________________________________________________________________________
user_location_input (InputLayer [(None, 3)]          0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 1, 8)     520         lambda_1[0][0]                   
__________________________________________________________________________________________________
book_blurb_input (InputLayer)   [(None, 200)]        0                                            
__________________________________________________________________________________________________
book_isbn_embedding (Embedding) (None, 1, 16)        608576      book_isbn_input[0][0]            
__________________________________________________________________________________________________
book_author_embedding (Embeddin (None, 1, 16)        243136      book_author_input[0][0]          
__________________________________________________________________________________________________
book_year_embedding (Embedding) (None, 1, 16)        1296        book_year_input[0][0]            
__________________________________________________________________________________________________
book_publisher_embedding (Embed (None, 1, 16)        46544       book_publisher_input[0][0]       
__________________________________________________________________________________________________
user_id_embedding (Embedding)   (None, 1, 16)        461376      user_id_input[0][0]              
__________________________________________________________________________________________________
user_loca_embedding (Embedding) (None, 3, 16)        121184      user_location_input[0][0]        
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 1, 1, 8)      0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
book_blurb_embedding (Embedding (None, 200, 32)      4069920     book_blurb_input[0][0]           
__________________________________________________________________________________________________
b_isbn_dense (Dense)            (None, 1, 16)        272         book_isbn_embedding[0][0]        
__________________________________________________________________________________________________
b_author_dense (Dense)          (None, 1, 16)        272         book_author_embedding[0][0]      
__________________________________________________________________________________________________
b_year_dense (Dense)            (None, 1, 16)        272         book_year_embedding[0][0]        
__________________________________________________________________________________________________
b_publisher_dense (Dense)       (None, 1, 16)        272         book_publisher_embedding[0][0]   
__________________________________________________________________________________________________
u_id_dense (Dense)              (None, 1, 64)        1088        user_id_embedding[0][0]          
__________________________________________________________________________________________________
u_loca_lstm (LSTM)              (None, 32)           6272        user_loca_embedding[0][0]        
__________________________________________________________________________________________________
reshape_3 (Reshape)             (None, 8)            0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
b_blurb_lstm (LSTM)             (None, 32)           8320        book_blurb_embedding[0][0]       
__________________________________________________________________________________________________
b_four_combine (Concatenate)    (None, 1, 64)        0           b_isbn_dense[0][0]               
                                                                 b_author_dense[0][0]             
                                                                 b_year_dense[0][0]               
                                                                 b_publisher_dense[0][0]          
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 64)           0           u_id_dense[0][0]                 
__________________________________________________________________________________________________
u_loca_layer_lstm (Dense)       (None, 64)           2112        u_loca_lstm[0][0]                
__________________________________________________________________________________________________
b_combine_blurb_title (Concaten (None, 40)           0           reshape_3[0][0]                  
                                                                 b_blurb_lstm[0][0]               
__________________________________________________________________________________________________
b_combine_four_reshape (Reshape (None, 64)           0           b_four_combine[0][0]             
__________________________________________________________________________________________________
u_combine (Concatenate)         (None, 128)          0           reshape_2[0][0]                  
                                                                 u_loca_layer_lstm[0][0]          
__________________________________________________________________________________________________
b_combine_book (Concatenate)    (None, 104)          0           b_combine_blurb_title[0][0]      
                                                                 b_combine_four_reshape[0][0]     
__________________________________________________________________________________________________
u_feature_layer (Dense)         (None, 200)          25800       u_combine[0][0]                  
__________________________________________________________________________________________________
b_feature_layer (Dense)         (None, 200)          21000       b_combine_book[0][0]             
__________________________________________________________________________________________________
user_book_feature (Lambda)      (None, 1)            0           u_feature_layer[0][0]            
                                                                 b_feature_layer[0][0]            
==================================================================================================
Total params: 6,380,312
Trainable params: 6,380,312
Non-trainable params: 0
```
### model_2
### model_3
### model_4